This code runs under the tensorflow2.0 deep learning framework.